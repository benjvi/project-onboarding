
# New Team Onboarding

This repository contains templates of the dev infrastructure that teams may need to be onboarded onto, including:
- Kubernetes namespace
- Harbor project
- Gitlab project

You can use this repository to request the infrastructure you need, based on these templates.

# Requests

## New Infrastructure

1. Clone this repository to your local machine
2. Create a new branch with git, e.g. : `git checkout -b new-project-<<PROJECT NAME>>`
3. From a bash terminal, run `generate-project.sh <<PROJECT NAME>>`. You will be prompted to enter the values for the project in the editor. These changes will be saved in a `terraform.tfvars` file
4. Publish the changes generated by the script to the Gitlab repo. A new folder containing the description of your resources should have been created in `deployed-projects/<<PROJECT NAME>>`. You can publish these changes via the habitual git commands or by using the helper script `push-project-changes.sh`
5. Create a Merge Request on Gitlab for your changes
6. Your Merge Request will be reviewed by the maintainers and, once merged, will be automatically provisioned by a Gitlab pipeline. You may review the logs of the pipeline to see what has been provisioned.

## Updating Infrastructure

For updates, you may follow the same process as requesting new infrastructure. It is foreseen that all updates should be achievable by changes to the variables in the `terraform.tfvars` file. If this is not the case, please log an issue for improving the templates.

## Deletion of Infrastructure

For deleting individual pieces of infrastructure, you may disable them following the same process as for creation and update, by setting the appropriate options in the `terraform.tfvars` file. Note that any provisioning that would delete a Kubernetes Namespace or Harbor Project will result in an error. This is to force manual review of such actions. Manual action to delete those objects will be required before the remaining automated provisioning actions will succeed.
